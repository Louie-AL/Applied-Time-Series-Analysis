"0",""
"0","y    <- ar1miss"
"0","num  <- length(y)"
"0","indicator <- array(1, dim=num)"
"0","A    <- array(0, dim=c(1,1,num))  # creates numxnum zero matrices"
"0",""
"0","for(k in 1:num){"
"0","  if (!(is.na(y[k]))){"
"0","    A[1,1,k] = 1"
"0","    indicator[k] = 0"
"0","  }"
"0","}"
"0",""
"0","# Initial values"
"0","mu0    <- 0"
"0","Sigma0 <- 1"
"0","Phi    <- 0.9"
"0","cQ     <- 0.01"
"0","cR     <- 0.0000000001"
"0",""
"0","for (i in 1:1000){"
"0","  invisible(capture.output(em <- EM(y, A, mu0, Sigma0, Phi, cQ, cR, max.iter = 1, tol = 0.1)))"
"0","  mu0    <- em$mu0"
"0","  Sigma0 <- em$Sigma0"
"0","  Phi    <- em$Phi"
"0","  cQ     <- em$Q"
"0","  cR     <- em$R"
"0","  "
"0","}"
"0",""
"0","# Graph smoother"
"0","ks  <- Ksmooth(y, A, em$mu0, em$Sigma0, em$Phi, t(chol(em$Q)), t(chol(em$R)), NULL, NULL, NULL)"
"0",""
"0","ys <- ks$Xs[1,,] "
"0","#y2s <- ks$Xs[2,,] "
"0","#y3s <- ks$Xs[3,,]"
"0","p1  <- 3*sqrt(ks$Ps[1,1,])"
"0","#p2  <- 2*sqrt(ks$Ps[2,2,]) "
"0","#p3  <- 2*sqrt(ks$Ps[3,3,])"
"0","plot(y, xlab='period')"
"2","Warning in gzfile(file, ""wb"") :"
"2","
 "
"2"," cannot open compressed file 'C:/Users/alons/OneDrive - Cornell University/Cornell University/Spring 2024/ORIE 5550/ORIE5550_Homework7/ORIE5550_Homeowork7/.Rproj.user/shared/notebooks/80CFCCFE-ORIE5550_Homework7_Markdown/1/89031309ff1922f/cyrcx4sdcl5qq_t/93299da397564666b5711be78aad0b63.snapshot', probable reason 'No such file or directory'
"
"2","Error in gzfile(file, ""wb"") : cannot open the connection
"
