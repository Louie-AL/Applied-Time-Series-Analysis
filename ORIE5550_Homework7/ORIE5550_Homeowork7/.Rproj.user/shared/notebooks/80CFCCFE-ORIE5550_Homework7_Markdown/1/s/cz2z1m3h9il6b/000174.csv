"0",""
"0","# Forecast"
"0","num <- length(ts.e1)"
"0","n.ahead <- 12"
"0","y       <- ts(append(ts.e1, rep(0,n.ahead)))"
"0","rmspe   <- rep(0,n.ahead)"
"0","x00     <- ks$Xf[,,num]"
"0","P00     <- ks$Pf[,,num]"
"0","Q       <- t(QQ) %*% QQ"
"0","R       <- RR^2"
"0","for (m in 1:n.ahead){"
"0","       xp <- Phi%*%x00"
"0","       Pp <- Phi%*%P00%*%t(Phi)+Q"
"0","      sig <- A%*%Pp%*%t(A)+R"
"0","        K <- Pp%*%t(A)%*%(1/sig)"
"0","      x00 <- xp "
"0","      P00 <- Pp-K%*%A%*%Pp"
"0"," y[num+m] <- A%*%xp"
"0"," rmspe[m] <- sqrt(sig) "
"0","}"
"0",""
"0","par(mfrow=c(1,1))"
