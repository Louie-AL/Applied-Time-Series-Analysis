"0","library(partsm)"
"0",""
"0","detcomp<-list(regular=c(0,0,0),seasonal=c(1,0),regvar=0)"
"0",""
"0","#lag section:"
"0","aic<-bic<-Fnextp<-Fpval<-rep(NA,10)"
"0","for(p in 1:10){"
"0","  "
"0"," lmpar<-fit.ar.par(wts=ts168_train3,type=""PAR"",detcomp=detcomp,p=p)"
"0"," aic[p]<-AIC(lmpar@lm.par,k=2)"
"0"," bic[p]<-BIC(lmpar@lm.par)"
"0"," "
"0"," #H_0:phi_{p+1,k}=0,k=1,...,s"
"0"," Fout<-Fnextp.test(wts=ts168_train3,detcomp=detcomp,p=p,type=""PAR"")"
"0"," Fnextp[p] <-Fout@Fstat"
"0"," Fpval[p]<-Fout@pval"
"0","}"
"0","which.min(aic)"
"1","[1]"
"1"," 10"
"1","
"
"0","which.min(bic)"
"1","[1]"
"1"," 4"
"1","
"
"0","p_par <- 8 # selected lag order"
"0","out.par<-fit.ar.par(wts=ts168_train3,type=""PAR"",detcomp=detcomp,p=p_par)"
"0","summary(out.par)"
"1","----
 "
"1"," "
"1","PAR model of order 8 .

"
"1","  y_t = alpha_{1,s}*y_{t-1} + alpha_{2,s}*y_{t-2} + ... + alpha_{p,s}*y_{t-p} + coeffs*detcomp + epsilon_t,  for s=1,2,...,7
"
"1","----
  Autoregressive coefficients. 

"
"1","        "
"1","   s=1"
"1","   s=2"
"1","   s=3"
"1","   s=4"
"1","   s=5"
"1","   s=6"
"1","   s=7"
"1","
alpha_1s"
"1","  0.30"
"1","  0.44"
"1","  0.78"
"1","  0.93"
"1"," -0.03"
"1","  0.79"
"1"," -0.30"
"1","
alpha_2s"
"1"," -1.98"
"1"," -0.95"
"1"," -0.50"
"1","  0.09"
"1","  0.76"
"1"," -0.43"
"1","  1.34"
"1","
alpha_3s"
"1","  0.81"
"1","  0.58"
"1"," -0.24"
"1"," -0.08"
"1","  0.05"
"1","  0.67"
"1","  0.18"
"1","
alpha_4s"
"1","  0.02"
"1","  1.12"
"1"," -0.43"
"1","  0.04"
"1"," -0.07"
"1"," -0.20"
"1","  0.25"
"1","
alpha_5s"
"1","  1.71"
"1"," -0.33"
"1","  0.88"
"1"," -0.03"
"1"," -0.23"
"1"," -0.15"
"1"," -0.56"
"1","
alpha_6s"
"1"," -0.53"
"1"," -0.79"
"1"," -0.23"
"1"," -0.45"
"1","  0.24"
"1"," -0.13"
"1"," -0.15"
"1","
alpha_7s"
"1"," -0.47"
"1","  0.72"
"1","  1.36"
"1","  0.00"
"1"," -0.35"
"1","  0.63"
"1"," -0.09"
"1","
alpha_8s"
"1"," -0.17"
"1"," -0.23"
"1"," -1.01"
"1","  0.34"
"1","  0.11"
"1"," -0.62"
"1","  0.31"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = MLag[, 1] ~ 0 + Yperlag + MDT)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","      Min "
"1","       1Q "
"1","   Median "
"1","       3Q "
"1","      Max "
"1","
"
"1","-0.165845 "
"1","-0.019437 "
"1"," 0.004217 "
"1"," 0.019017 "
"1"," 0.174205 "
"1","
"
"1","
Coefficients:
"
"1","              "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
Yperlag1      "
"1","  0.2970469"
"1","  0.2763728"
"1","   1.075"
"1"," 0.285335"
"1","    "
"1","
Yperlag2      "
"1","  0.4376728"
"1","  0.1451794"
"1","   3.015"
"1"," 0.003342"
"1"," ** "
"1","
Yperlag3      "
"1","  0.7834168"
"1","  0.2554004"
"1","   3.067"
"1"," 0.002852"
"1"," ** "
"1","
Yperlag4      "
"1","  0.9294740"
"1","  0.2108045"
"1","   4.409"
"1"," 2.86e-05"
"1"," ***"
"1","
Yperlag5      "
"1"," -0.0276388"
"1","  0.4880259"
"1","  -0.057"
"1"," 0.954962"
"1","    "
"1","
Yperlag6      "
"1","  0.7857980"
"1","  0.6315549"
"1","   1.244"
"1"," 0.216646"
"1","    "
"1","
Yperlag7      "
"1"," -0.2968213"
"1","  0.3997634"
"1","  -0.742"
"1"," 0.459722"
"1","    "
"1","
Yperlag8      "
"1"," -1.9755837"
"1","  0.3454727"
"1","  -5.718"
"1"," 1.38e-07"
"1"," ***"
"1","
Yperlag9      "
"1"," -0.9531476"
"1","  0.2642833"
"1","  -3.607"
"1"," 0.000509"
"1"," ***"
"1","
Yperlag10     "
"1"," -0.4970326"
"1","  0.1906096"
"1","  -2.608"
"1"," 0.010674"
"1"," *  "
"1","
Yperlag11     "
"1","  0.0899686"
"1","  0.1946471"
"1","   0.462"
"1"," 0.645043"
"1","    "
"1","
Yperlag12     "
"1","  0.7560470"
"1","  0.5069135"
"1","   1.491"
"1"," 0.139335"
"1","    "
"1","
Yperlag13     "
"1"," -0.4349750"
"1","  0.4675639"
"1","  -0.930"
"1"," 0.354704"
"1","    "
"1","
Yperlag14     "
"1","  1.3389783"
"1","  0.7456154"
"1","   1.796"
"1"," 0.075882"
"1"," .  "
"1","
Yperlag15     "
"1","  0.8115199"
"1","  0.8235591"
"1","   0.985"
"1"," 0.327078"
"1","    "
"1","
Yperlag16     "
"1","  0.5842884"
"1","  0.4411866"
"1","   1.324"
"1"," 0.188738"
"1","    "
"1","
Yperlag17     "
"1"," -0.2408447"
"1","  0.3461517"
"1","  -0.696"
"1"," 0.488361"
"1","    "
"1","
Yperlag18     "
"1"," -0.0829518"
"1","  0.1525805"
"1","  -0.544"
"1"," 0.588020"
"1","    "
"1","
Yperlag19     "
"1","  0.0511732"
"1","  0.1790339"
"1","   0.286"
"1"," 0.775665"
"1","    "
"1","
Yperlag20     "
"1","  0.6745934"
"1","  0.6629476"
"1","   1.018"
"1"," 0.311612"
"1","    "
"1","
Yperlag21     "
"1","  0.1779224"
"1","  0.5044365"
"1","   0.353"
"1"," 0.725127"
"1","    "
"1","
Yperlag22     "
"1","  0.0219159"
"1","  0.5032336"
"1","   0.044"
"1"," 0.965359"
"1","    "
"1","
Yperlag23     "
"1","  1.1238534"
"1","  0.6504854"
"1","   1.728"
"1"," 0.087469"
"1"," .  "
"1","
Yperlag24     "
"1"," -0.4277179"
"1","  0.4468312"
"1","  -0.957"
"1"," 0.341018"
"1","    "
"1","
Yperlag25     "
"1","  0.0440500"
"1","  0.3532532"
"1","   0.125"
"1"," 0.901041"
"1","    "
"1","
Yperlag26     "
"1"," -0.0650462"
"1","  0.1523141"
"1","  -0.427"
"1"," 0.670360"
"1","    "
"1","
Yperlag27     "
"1"," -0.1967853"
"1","  0.1580385"
"1","  -1.245"
"1"," 0.216300"
"1","    "
"1","
Yperlag28     "
"1","  0.2487334"
"1","  0.6679831"
"1","   0.372"
"1"," 0.710497"
"1","    "
"1","
Yperlag29     "
"1","  1.7077754"
"1","  0.6593254"
"1","   2.590"
"1"," 0.011188"
"1"," *  "
"1","
Yperlag30     "
"1"," -0.3299316"
"1","  0.5000013"
"1","  -0.660"
"1"," 0.511028"
"1","    "
"1","
Yperlag31     "
"1","  0.8846649"
"1","  0.6969607"
"1","   1.269"
"1"," 0.207600"
"1","    "
"1","
Yperlag32     "
"1"," -0.0278670"
"1","  0.3095757"
"1","  -0.090"
"1"," 0.928474"
"1","    "
"1","
Yperlag33     "
"1"," -0.2307028"
"1","  0.3431537"
"1","  -0.672"
"1"," 0.503114"
"1","    "
"1","
Yperlag34     "
"1"," -0.1480456"
"1","  0.1403875"
"1","  -1.055"
"1"," 0.294454"
"1","    "
"1","
Yperlag35     "
"1"," -0.5579917"
"1","  0.1878840"
"1","  -2.970"
"1"," 0.003819"
"1"," ** "
"1","
Yperlag36     "
"1"," -0.5258844"
"1","  0.2227205"
"1","  -2.361"
"1"," 0.020375"
"1"," *  "
"1","
Yperlag37     "
"1"," -0.7867084"
"1","  0.5998091"
"1","  -1.312"
"1"," 0.192992"
"1","    "
"1","
Yperlag38     "
"1"," -0.2275634"
"1","  0.4908937"
"1","  -0.464"
"1"," 0.644075"
"1","    "
"1","
Yperlag39     "
"1"," -0.4471548"
"1","  0.6670676"
"1","  -0.670"
"1"," 0.504365"
"1","    "
"1","
Yperlag40     "
"1","  0.2388382"
"1","  0.3096849"
"1","   0.771"
"1"," 0.442591"
"1","    "
"1","
Yperlag41     "
"1"," -0.1300298"
"1","  0.3721360"
"1","  -0.349"
"1"," 0.727594"
"1","    "
"1","
Yperlag42     "
"1"," -0.1540174"
"1","  0.1554694"
"1","  -0.991"
"1"," 0.324507"
"1","    "
"1","
Yperlag43     "
"1"," -0.4744202"
"1","  0.1698555"
"1","  -2.793"
"1"," 0.006378"
"1"," ** "
"1","
Yperlag44     "
"1","  0.7179648"
"1","  0.2341504"
"1","   3.066"
"1"," 0.002862"
"1"," ** "
"1","
Yperlag45     "
"1","  1.3612870"
"1","  0.5872528"
"1","   2.318"
"1"," 0.022713"
"1"," *  "
"1","
Yperlag46     "
"1"," -0.0029297"
"1","  0.4940339"
"1","  -0.006"
"1"," 0.995282"
"1","    "
"1","
Yperlag47     "
"1"," -0.3510547"
"1","  0.6225694"
"1","  -0.564"
"1"," 0.574238"
"1","    "
"1","
Yperlag48     "
"1","  0.6325859"
"1","  0.3407960"
"1","   1.856"
"1"," 0.066697"
"1"," .  "
"1","
Yperlag49     "
"1"," -0.0878474"
"1","  0.3765158"
"1","  -0.233"
"1"," 0.816045"
"1","    "
"1","
Yperlag50     "
"1"," -0.1721216"
"1","  0.1867337"
"1","  -0.922"
"1"," 0.359124"
"1","    "
"1","
Yperlag51     "
"1"," -0.2345411"
"1","  0.1408335"
"1","  -1.665"
"1"," 0.099315"
"1"," .  "
"1","
Yperlag52     "
"1"," -1.0135155"
"1","  0.3074453"
"1","  -3.297"
"1"," 0.001402"
"1"," ** "
"1","
Yperlag53     "
"1","  0.3391015"
"1","  0.4850414"
"1","   0.699"
"1"," 0.486281"
"1","    "
"1","
Yperlag54     "
"1","  0.1131806"
"1","  0.3853184"
"1","   0.294"
"1"," 0.769638"
"1","    "
"1","
Yperlag55     "
"1"," -0.6173704"
"1","  0.3854633"
"1","  -1.602"
"1"," 0.112741"
"1","    "
"1","
Yperlag56     "
"1","  0.3105036"
"1","  0.3870614"
"1","   0.802"
"1"," 0.424546"
"1","    "
"1","
MDT..SeasDum.1"
"1"," -0.0333986"
"1","  0.0119971"
"1","  -2.784"
"1"," 0.006546"
"1"," ** "
"1","
MDT..SeasDum.2"
"1"," -0.0336514"
"1","  0.0118932"
"1","  -2.829"
"1"," 0.005749"
"1"," ** "
"1","
MDT..SeasDum.3"
"1","  0.0112834"
"1","  0.0139887"
"1","   0.807"
"1"," 0.422016"
"1","    "
"1","
MDT..SeasDum.4"
"1","  0.0003547"
"1","  0.0130286"
"1","   0.027"
"1"," 0.978342"
"1","    "
"1","
MDT..SeasDum.5"
"1"," -0.0008530"
"1","  0.0128976"
"1","  -0.066"
"1"," 0.947416"
"1","    "
"1","
MDT..SeasDum.6"
"1","  0.0080054"
"1","  0.0128033"
"1","   0.625"
"1"," 0.533383"
"1","    "
"1","
MDT..SeasDum.7"
"1","  0.0010082"
"1","  0.0117965"
"1","   0.085"
"1"," 0.932079"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.05248"
"1"," "
"1","on"
"1"," "
"1","90"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","8 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.9135"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.853"
"1"," "
"1","
F-statistic:"
"1"," "
"1","15.09"
"1"," "
"1","on"
"1"," "
"1","63"
"1"," "
"1","and"
"1"," "
"1","90"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# SARMA Model"
"0","# seasonality 7"
"0","ts168_train3 <- ts(ts168_train3, frequency=7)"
"0","# only allow p and P lags"
"0","SARMA_q4 <- auto.arima(ts168_train3, max.p = 10, max.q = 0, max.d = 0,"
"0","                        start.p = 0, start.q = 0,"
"0","                        max.P = 10, max.Q = 0, max.D = 0,"
"0","                        start.P = 0, start.Q = 0,"
"0","                        allowdrift = FALSE, ic = ""aic"")"
"0","summary(SARMA_q4)"
"1","Series:"
"1"," "
"1","ts168_train3"
"1"," "
"1","
"
"1","ARIMA(1,0,0)(2,0,0)[7] with zero mean"
"1"," "
"1","
"
"1","
Coefficients:
"
"1","    "
"1","     ar1"
"1","    sar1"
"1","    sar2"
"1","
    "
"1","  0.7191"
"1","  0.5671"
"1","  0.3037"
"1","
s.e."
"1","  0.0556"
"1","  0.0743"
"1","  0.0786"
"1","
"
"1","
sigma^2 = "
"1",""
"1","0.007292"
"1",":  log likelihood = "
"1",""
"1","164.29"
"1","
"
"1","AIC="
"1",""
"1","-320.57"
"1","   AICc="
"1",""
"1","-320.32"
"1","   BIC="
"1",""
"1","-308.25"
"1",""
"1","
"
"1","
Training set error measures:
"
"1","            "
"1","           ME"
"1","       RMSE"
"1","        MAE"
"1","       MPE"
"1","     MAPE"
"1","      MASE"
"1","       ACF1"
"1","
Training set"
"1"," -0.003603748"
"1"," 0.08459609"
"1"," 0.06026708"
"1"," -62.83334"
"1"," 170.4757"
"1"," 0.5781909"
"1"," 0.05358782"
"1","
"
