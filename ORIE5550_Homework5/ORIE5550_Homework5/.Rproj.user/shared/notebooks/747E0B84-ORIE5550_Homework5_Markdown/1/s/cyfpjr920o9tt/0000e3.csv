"0","forecasted_residuals<-matrix(0,nrow=1,ncol=12)"
"0","for (i in 1:12) {"
"0","  forecasted_residuals[1,i]<-as.numeric(residuals.forecast$mean)[i]"
"0","}"
"0",""
"0","estimated_coeffs<-matrix(0,nrow=1,ncol=9)"
"0","for (i in 1:9) {"
"0","  estimated_coeffs[1,i]<-fitModel$coefficients[i]"
"0","}"
"0",""
"0","time_matrix<-matrix(0,nrow=12,ncol=9)"
"0","time_matrix[,1]<- 1"
"0","time_matrix[,2]<- 361:372"
"0","time_matrix[,3]<- time_matrix[,2]^2"
"0","time_matrix[,4]<- cos(2 * time_matrix[,2] * pi / 12)"
"0","time_matrix[,5]<- sin(2 * time_matrix[,2] * pi / 12)"
"0","time_matrix[,6]<- cos(2 * time_matrix[,2] * pi / 6)"
"0","time_matrix[,7]<- sin(2 * time_matrix[,2] * pi / 6)"
"0","time_matrix[,8]<- cos(2 * time_matrix[,2] * pi / 4)"
"0","time_matrix[,9]<- sin(2 * time_matrix[,2] * pi / 4)"
"0","time_matrix<-t(time_matrix)"
"0",""
"0","trendAndseasonal_forecast = estimated_coeffs %*% time_matrix"
"0","ts.forecast.pred<-trendAndseasonal_forecast + forecasted_residuals"
"0","exp(ts.forecast.pred)"
"1","    "
"1","     [,1]"
"1","     [,2]"
"1","    [,3]"
"1","     [,4]"
"1","     [,5]"
"1","     [,6]"
"1","     [,7]"
"1","     [,8]"
"1","     [,9]"
"1","    [,10]"
"1","    [,11]"
"1","
[1,]"
"1"," 695.1989"
"1"," 720.4996"
"1"," 687.389"
"1"," 622.2749"
"1"," 600.5097"
"1"," 704.5926"
"1"," 687.6466"
"1"," 654.1976"
"1"," 627.7188"
"1"," 615.9107"
"1"," 631.9977"
"1","
"
"1","    "
"1","   [,12]"
"1","
[1,]"
"1"," 629.525"
"1","
"
"0","msfe_2a <-mean((exp(ts.forecast.pred)-as.numeric(test_data))^2)"
"0","msfe_2a"
"1","[1]"
"1"," 2973.572"
"1","
"
"0","##############"
"0","##Fitted values"
"0",""
"0",""
"0","estimated_coeffs<-matrix(0,nrow=1,ncol=9)"
"0","for (i in 1:9) {"
"0","  estimated_coeffs[1,i]<-fitModel$coefficients[i]"
"0","}"
"0",""
"0","time_matrix<-matrix(0,nrow=360,ncol=9)"
"0","time_matrix[,1]<- 1"
"0","time_matrix[,2]<- 1:360"
"0","time_matrix[,3]<- time_matrix[,2]^2"
"0","time_matrix[,4]<- cos(2 * time_matrix[,2] * pi / 12)"
"0","time_matrix[,5]<- sin(2 * time_matrix[,2] * pi / 12)"
"0","time_matrix[,6]<- cos(2 * time_matrix[,2] * pi / 6)"
"0","time_matrix[,7]<- sin(2 * time_matrix[,2] * pi / 6)"
"0","time_matrix[,8]<- cos(2 * time_matrix[,2] * pi / 4)"
"0","time_matrix[,9]<- sin(2 * time_matrix[,2] * pi / 4)"
"0","time_matrix<-t(time_matrix)"
"0",""
"0","fitted_values = estimated_coeffs %*% time_matrix"
"0",""
"0",""
"0","#Plotting"
"0",""
"0","library(ggplot2)"
"0","library(tidyr)"
"0",""
"0","df1 <- data.frame(train_compare = exp(training_data), timestamp = seq(1,360,1))"
"0","df2 <- data.frame(forecast_data = as.numeric(exp(ts.forecast.pred)), timestamp = seq(361,372,1))"
"0","df3 <- data.frame(fitted_compare = as.numeric(exp(estimated_coeffs %*% time_matrix)), timestamp = seq(1,360,1))"
"0","merged_df <- merge(df1, df2, by = ""timestamp"", all = TRUE)"
"0","merged_df <- merge(merged_df, df3, by = ""timestamp"", all = TRUE)"
"0",""
"0","ggplot(merged_df, aes(x = timestamp)) +"
"0","  geom_line(aes(y = train_compare, color = ""Training Data"")) +"
"0","  geom_line(aes(y = forecast_data, color = ""Forecast Data"")) +"
"0","  geom_line(aes(y = fitted_compare, color = ""Fitted Values"")) +"
"0","  labs(x = ""Timestamp"", y = ""Value"", color = ""Data Type"") +"
"0","  ggtitle(""Original, Fitted and Forecasted TS"") +"
"0","  theme_minimal()"
"2","Warning in gzfile(file, ""wb"") :"
"2","
 "
"2"," cannot open compressed file 'C:/Users/alons/OneDrive - Cornell University/Cornell University/Spring 2024/ORIE 5550/ORIE5550_Homework5/ORIE5550_Homework5/.Rproj.user/shared/notebooks/747E0B84-ORIE5550_Homework5_Markdown/1/8903130956e3b23f/cyfpjr920o9tt_t/379a2282b31947838fc61e2fd7e1c4e8.snapshot', probable reason 'No such file or directory'
"
"2","Error in gzfile(file, ""wb"") : cannot open the connection
"
